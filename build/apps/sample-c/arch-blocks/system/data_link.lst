   1               		.file	"data_link.c"
   2               	__SP_H__ = 0x3e
   3               	__SP_L__ = 0x3d
   4               	__SREG__ = 0x3f
   5               	__RAMPZ__ = 0x3b
   6               	__CCP__ = 0x34
   7               	__tmp_reg__ = 0
   8               	__zero_reg__ = 1
   9               		.text
  10               	.Ltext0:
  11               	.global	defaultMsgHandler
  13               	defaultMsgHandler:
  14               	.LFB6:
  15               		.file 1 "/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb"
   1:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb **** // data_link.c
   2:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb **** //
   3:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb **** // Implement Data Link Layer protocols
   4:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb **** 
   5:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb **** #ifndef _DATA_LINK_C_
   6:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb **** #define _DATA_LINK_C_
   7:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb **** 
   8:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb **** #include "../hw-api/hwDataLink.h"
   9:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb **** #include "../hw-api/hwSerial.h"
  10:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb **** #include "data_link.bbh"
  11:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb **** #include "led.bbh"
  12:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb **** 
  13:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb **** 
  14:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb **** // global receive queue for packets
  15:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb **** // move to network layer???
  16:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb **** threadvar ReceivePacketQueue globalRq;
  17:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb **** 
  18:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb **** threadextern Port port[NUM_PORTS];
  19:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb **** 
  20:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb **** // used to allow message handler and callbacks access to state
  21:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb **** threadvar Chunk* thisChunk;
  22:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb **** 
  23:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb **** /////////////////// PROTECTED FUNCTIONS ///////////////////
  24:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb **** // default message handler - does nothing
  25:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb **** byte defaultMsgHandler(void)
  26:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb **** {
  16               		.loc 1 26 0
  17               	/* prologue: function */
  18               	/* frame size = 0 */
  19               	/* stack size = 0 */
  20               	.L__stack_usage = 0
  27:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb ****     return 1;
  28:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb **** }
  21               		.loc 1 28 0
  22 0000 81E0      		ldi r24,lo8(1)
  23 0002 0895      		ret
  24               	.LFE6:
  26               	.global	reservedSystemHandler
  28               	reservedSystemHandler:
  29               	.LFB7:
  29:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb **** 
  30:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb **** // handler for reserved system mesages
  31:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb **** //   using 0x0000 as message handler allows blocks 
  32:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb **** //   running different programs to communicate at the system level.
  33:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb **** byte reservedSystemHandler(void)
  34:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb **** {
  30               		.loc 1 34 0
  31               	/* prologue: function */
  32               	/* frame size = 0 */
  33               	/* stack size = 0 */
  34               	.L__stack_usage = 0
  35:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb ****     // bogus
  36:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb ****     if(thisChunk == NULL) {
  35               		.loc 1 36 0
  36 0004 E091 0000 		lds r30,thisChunk
  37 0008 F091 0000 		lds r31,thisChunk+1
  38 000c 3097      		sbiw r30,0
  39 000e 01F0      		breq .L3
  37:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb ****         return 0;
  38:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb ****     }
  39:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb ****   
  40:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb ****     // find msg type and check
  41:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb ****     switch( thisChunk->data[0] )
  40               		.loc 1 41 0
  41 0010 8081      		ld r24,Z
  42 0012 8130      		cpi r24,lo8(1)
  43 0014 01F0      		breq .L4
  44 0016 8F3F      		cpi r24,lo8(-1)
  45 0018 01F4      		brne .L3
  46               	.LBB12:
  42:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb ****     {
  43:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb ****         case JUMP_BOOTLOADER: // CRC for this message: 0x2A
  44:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb ****         {
  45:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb **** 	        int i = 1;
  46:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb **** 	
  47:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb **** 	        // check msg consistency
  48:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb **** 	        while( i < DATA_SIZE ) {
  49:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb **** 	            if( thisChunk->data[i] != (JUMP_BOOTLOADER ^ i) ) {
  50:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb **** 	                // invalid bootloader packet, break and do nothing
  51:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb **** 	                break;
  52:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb **** 	            }
  53:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb **** 	            i++;
  54:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb **** 	        }
  55:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb **** 	        // consistent
  56:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb ****     	    jumpToBootSection();
  47               		.loc 1 56 0
  48 001a 0E94 0000 		call jumpToBootSection
  49               	.LVL0:
  50               	.L4:
  51               	.LBE12:
  57:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb ****         }
  58:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb ****         case NEIGHBOR_MSG:
  59:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb ****             handleNeighborMessage();
  52               		.loc 1 59 0
  53 001e 0E94 0000 		call handleNeighborMessage
  54               	.LVL1:
  55               	.L3:
  60:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb ****             break;
  61:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb ****         default:
  62:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb ****             break;
  63:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb ****     }
  64:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb ****   
  65:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb ****     return 0;
  66:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb **** }
  56               		.loc 1 66 0
  57 0022 80E0      		ldi r24,0
  58 0024 0895      		ret
  59               	.LFE7:
  61               	.global	removeFromSq
  63               	removeFromSq:
  64               	.LFB8:
  67:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb **** 
  68:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb **** // removes the first packet from the send queue and
  69:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb **** //    updates pointers
  70:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb **** //    updates pointers
  71:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb **** // inputs:  port
  72:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb **** // output:  1-success, 0-failure
  73:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb **** byte removeFromSq(PRef p, byte response)
  74:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb **** {
  65               		.loc 1 74 0
  66               	.LVL2:
  67               	/* prologue: function */
  68               	/* frame size = 0 */
  69               	/* stack size = 0 */
  70               	.L__stack_usage = 0
  75:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb ****     // empty or bad
  76:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb ****     if( (p >= NUM_PORTS) || (port[p].sq.head == NULL) ) 
  71               		.loc 1 76 0
  72 0026 8630      		cpi r24,lo8(6)
  73 0028 00F0      		brlo .+2
  74 002a 00C0      		rjmp .L19
  75               		.loc 1 76 0 is_stmt 0 discriminator 1
  76 002c 98E5      		ldi r25,lo8(88)
  77 002e 899F      		mul r24,r25
  78 0030 F001      		movw r30,r0
  79 0032 1124      		clr __zero_reg__
  80 0034 E050      		subi r30,lo8(-(port))
  81 0036 F040      		sbci r31,hi8(-(port))
  82 0038 8785      		ldd r24,Z+15
  83 003a 9089      		ldd r25,Z+16
  84               	.LVL3:
  85 003c 892B      		or r24,r25
  86 003e 01F0      		breq .L19
  87               	.LBB13:
  77:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb ****     {
  78:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb ****         return 0;
  79:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb ****     }
  80:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb **** 
  81:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb ****     BB_LOCK(SQ_LOCK)
  88               		.loc 1 81 0 is_stmt 1
  89 0040 2FB7      		in r18,__SREG__
  90               	.LVL4:
  91               	.LBB14:
  92               	.LBB15:
  93               		.file 2 "/usr/lib/gcc/avr/4.7.2/../../../avr/include/util/atomic.h"
   1:/usr/lib/gcc/avr/4.7.2/../../../avr/include/util/atomic.h **** /* Copyright (c) 2007 Dean Camera
   2:/usr/lib/gcc/avr/4.7.2/../../../avr/include/util/atomic.h ****    All rights reserved.
   3:/usr/lib/gcc/avr/4.7.2/../../../avr/include/util/atomic.h **** 
   4:/usr/lib/gcc/avr/4.7.2/../../../avr/include/util/atomic.h ****    Redistribution and use in source and binary forms, with or without
   5:/usr/lib/gcc/avr/4.7.2/../../../avr/include/util/atomic.h ****    modification, are permitted provided that the following conditions are met:
   6:/usr/lib/gcc/avr/4.7.2/../../../avr/include/util/atomic.h **** 
   7:/usr/lib/gcc/avr/4.7.2/../../../avr/include/util/atomic.h ****    * Redistributions of source code must retain the above copyright
   8:/usr/lib/gcc/avr/4.7.2/../../../avr/include/util/atomic.h ****      notice, this list of conditions and the following disclaimer.
   9:/usr/lib/gcc/avr/4.7.2/../../../avr/include/util/atomic.h **** 
  10:/usr/lib/gcc/avr/4.7.2/../../../avr/include/util/atomic.h ****    * Redistributions in binary form must reproduce the above copyright
  11:/usr/lib/gcc/avr/4.7.2/../../../avr/include/util/atomic.h ****      notice, this list of conditions and the following disclaimer in
  12:/usr/lib/gcc/avr/4.7.2/../../../avr/include/util/atomic.h ****      the documentation and/or other materials provided with the
  13:/usr/lib/gcc/avr/4.7.2/../../../avr/include/util/atomic.h ****      distribution.
  14:/usr/lib/gcc/avr/4.7.2/../../../avr/include/util/atomic.h **** 
  15:/usr/lib/gcc/avr/4.7.2/../../../avr/include/util/atomic.h ****    * Neither the name of the copyright holders nor the names of
  16:/usr/lib/gcc/avr/4.7.2/../../../avr/include/util/atomic.h ****      contributors may be used to endorse or promote products derived
  17:/usr/lib/gcc/avr/4.7.2/../../../avr/include/util/atomic.h ****      from this software without specific prior written permission.
  18:/usr/lib/gcc/avr/4.7.2/../../../avr/include/util/atomic.h **** 
  19:/usr/lib/gcc/avr/4.7.2/../../../avr/include/util/atomic.h ****   THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS"
  20:/usr/lib/gcc/avr/4.7.2/../../../avr/include/util/atomic.h ****   AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
  21:/usr/lib/gcc/avr/4.7.2/../../../avr/include/util/atomic.h ****   IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
  22:/usr/lib/gcc/avr/4.7.2/../../../avr/include/util/atomic.h ****   ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE
  23:/usr/lib/gcc/avr/4.7.2/../../../avr/include/util/atomic.h ****   LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR
  24:/usr/lib/gcc/avr/4.7.2/../../../avr/include/util/atomic.h ****   CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF
  25:/usr/lib/gcc/avr/4.7.2/../../../avr/include/util/atomic.h ****   SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS
  26:/usr/lib/gcc/avr/4.7.2/../../../avr/include/util/atomic.h ****   INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN
  27:/usr/lib/gcc/avr/4.7.2/../../../avr/include/util/atomic.h ****   CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
  28:/usr/lib/gcc/avr/4.7.2/../../../avr/include/util/atomic.h ****   ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
  29:/usr/lib/gcc/avr/4.7.2/../../../avr/include/util/atomic.h ****   POSSIBILITY OF SUCH DAMAGE.
  30:/usr/lib/gcc/avr/4.7.2/../../../avr/include/util/atomic.h **** */
  31:/usr/lib/gcc/avr/4.7.2/../../../avr/include/util/atomic.h **** 
  32:/usr/lib/gcc/avr/4.7.2/../../../avr/include/util/atomic.h **** /* $Id: atomic.h 2158 2010-06-10 15:48:28Z joerg_wunsch $ */
  33:/usr/lib/gcc/avr/4.7.2/../../../avr/include/util/atomic.h **** 
  34:/usr/lib/gcc/avr/4.7.2/../../../avr/include/util/atomic.h **** #ifndef _UTIL_ATOMIC_H_
  35:/usr/lib/gcc/avr/4.7.2/../../../avr/include/util/atomic.h **** #define _UTIL_ATOMIC_H_ 1
  36:/usr/lib/gcc/avr/4.7.2/../../../avr/include/util/atomic.h **** 
  37:/usr/lib/gcc/avr/4.7.2/../../../avr/include/util/atomic.h **** #include <avr/io.h>
  38:/usr/lib/gcc/avr/4.7.2/../../../avr/include/util/atomic.h **** #include <avr/interrupt.h>
  39:/usr/lib/gcc/avr/4.7.2/../../../avr/include/util/atomic.h **** 
  40:/usr/lib/gcc/avr/4.7.2/../../../avr/include/util/atomic.h **** #if !defined(__DOXYGEN__)
  41:/usr/lib/gcc/avr/4.7.2/../../../avr/include/util/atomic.h **** /* Internal helper functions. */
  42:/usr/lib/gcc/avr/4.7.2/../../../avr/include/util/atomic.h **** static __inline__ uint8_t __iSeiRetVal(void)
  43:/usr/lib/gcc/avr/4.7.2/../../../avr/include/util/atomic.h **** {
  44:/usr/lib/gcc/avr/4.7.2/../../../avr/include/util/atomic.h ****     sei();
  45:/usr/lib/gcc/avr/4.7.2/../../../avr/include/util/atomic.h ****     return 1;
  46:/usr/lib/gcc/avr/4.7.2/../../../avr/include/util/atomic.h **** }
  47:/usr/lib/gcc/avr/4.7.2/../../../avr/include/util/atomic.h **** 
  48:/usr/lib/gcc/avr/4.7.2/../../../avr/include/util/atomic.h **** static __inline__ uint8_t __iCliRetVal(void)
  49:/usr/lib/gcc/avr/4.7.2/../../../avr/include/util/atomic.h **** {
  50:/usr/lib/gcc/avr/4.7.2/../../../avr/include/util/atomic.h ****     cli();
  94               		.loc 2 50 0
  95               	/* #APP */
  96               	 ;  50 "/usr/lib/gcc/avr/4.7.2/../../../avr/include/util/atomic.h" 1
  97 0042 F894      		cli
  98               	 ;  0 "" 2
  99               	.LVL5:
 100               	/* #NOAPP */
 101               	.LBE15:
 102               	.LBE14:
  82:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb **** 
  83:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb ****     // get the first Chunk
  84:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb ****     thisChunk = port[p].sq.head;
 103               		.loc 1 84 0
 104 0044 A785      		ldd r26,Z+15
 105 0046 B089      		ldd r27,Z+16
  85:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb **** 
  86:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb ****     // move the head of the queue
  87:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb ****     port[p].sq.head = thisChunk->next;
 106               		.loc 1 87 0
 107 0048 5296      		adiw r26,18
 108 004a 8D91      		ld r24,X+
 109 004c 9C91      		ld r25,X
 110 004e 5397      		sbiw r26,18+1
 111 0050 8787      		std Z+15,r24
 112 0052 908B      		std Z+16,r25
  88:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb **** 
  89:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb ****     // tail was pointing to head, remove tail as well
  90:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb ****     if( port[p].sq.head == NULL ) 
 113               		.loc 1 90 0
 114 0054 892B      		or r24,r25
 115 0056 01F0      		breq .L14
 116               	.LVL6:
 117               	.L20:
 118 0058 A093 0000 		sts thisChunk,r26
 119 005c B093 0000 		sts thisChunk+1,r27
 120               	.LBB16:
 121               	.LBB17:
  51:/usr/lib/gcc/avr/4.7.2/../../../avr/include/util/atomic.h ****     return 1;
  52:/usr/lib/gcc/avr/4.7.2/../../../avr/include/util/atomic.h **** }
  53:/usr/lib/gcc/avr/4.7.2/../../../avr/include/util/atomic.h **** 
  54:/usr/lib/gcc/avr/4.7.2/../../../avr/include/util/atomic.h **** static __inline__ void __iSeiParam(const uint8_t *__s)
  55:/usr/lib/gcc/avr/4.7.2/../../../avr/include/util/atomic.h **** {
  56:/usr/lib/gcc/avr/4.7.2/../../../avr/include/util/atomic.h ****     sei();
  57:/usr/lib/gcc/avr/4.7.2/../../../avr/include/util/atomic.h ****     __asm__ volatile ("" ::: "memory");
  58:/usr/lib/gcc/avr/4.7.2/../../../avr/include/util/atomic.h ****     (void)__s;
  59:/usr/lib/gcc/avr/4.7.2/../../../avr/include/util/atomic.h **** }
  60:/usr/lib/gcc/avr/4.7.2/../../../avr/include/util/atomic.h **** 
  61:/usr/lib/gcc/avr/4.7.2/../../../avr/include/util/atomic.h **** static __inline__ void __iCliParam(const uint8_t *__s)
  62:/usr/lib/gcc/avr/4.7.2/../../../avr/include/util/atomic.h **** {
  63:/usr/lib/gcc/avr/4.7.2/../../../avr/include/util/atomic.h ****     cli();
  64:/usr/lib/gcc/avr/4.7.2/../../../avr/include/util/atomic.h ****     __asm__ volatile ("" ::: "memory");
  65:/usr/lib/gcc/avr/4.7.2/../../../avr/include/util/atomic.h ****     (void)__s;
  66:/usr/lib/gcc/avr/4.7.2/../../../avr/include/util/atomic.h **** }
  67:/usr/lib/gcc/avr/4.7.2/../../../avr/include/util/atomic.h **** 
  68:/usr/lib/gcc/avr/4.7.2/../../../avr/include/util/atomic.h **** static __inline__ void __iRestore(const  uint8_t *__s)
  69:/usr/lib/gcc/avr/4.7.2/../../../avr/include/util/atomic.h **** {
  70:/usr/lib/gcc/avr/4.7.2/../../../avr/include/util/atomic.h ****     SREG = *__s;
 122               		.loc 2 70 0
 123 0060 2FBF      		out __SREG__,r18
  71:/usr/lib/gcc/avr/4.7.2/../../../avr/include/util/atomic.h ****     __asm__ volatile ("" ::: "memory");
 124               		.loc 2 71 0
 125               	.LBE17:
 126               	.LBE16:
 127               	.LBE13:
  91:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb ****     {
  92:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb ****         port[p].sq.tail   = NULL;
  93:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb ****         port[p].sq.flags &= ~CHUNK_READY;
  94:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb ****     }
  95:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb ****     // otherwise, leave it to what it was pointing to
  96:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb **** 
  97:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb ****     BB_UNLOCK(SQ_LOCK)
  98:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb **** 
  99:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb ****     // remove thisChunk's references to queue
 100:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb ****     thisChunk->next = NULL;
 128               		.loc 1 100 0
 129 0062 A091 0000 		lds r26,thisChunk
 130 0066 B091 0000 		lds r27,thisChunk+1
 131 006a 5296      		adiw r26,18
 132 006c 1D92      		st X+,__zero_reg__
 133 006e 1C92      		st X,__zero_reg__
 134 0070 5397      		sbiw r26,18+1
 101:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb **** 
 102:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb ****     if(thisChunk->callback != NULL)
 135               		.loc 1 102 0
 136 0072 5696      		adiw r26,22
 137 0074 ED91      		ld r30,X+
 138 0076 FC91      		ld r31,X
 139 0078 5797      		sbiw r26,22+1
 140 007a 3097      		sbiw r30,0
 141 007c 01F4      		brne .L15
 142 007e 00C0      		rjmp .L16
 143               	.LVL7:
 144               	.L14:
 145               	.LBB18:
  92:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb ****         port[p].sq.tail   = NULL;
 146               		.loc 1 92 0
 147 0080 118A      		std Z+17,__zero_reg__
 148 0082 128A      		std Z+18,__zero_reg__
  93:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb ****         port[p].sq.flags &= ~CHUNK_READY;
 149               		.loc 1 93 0
 150 0084 8685      		ldd r24,Z+14
 151 0086 8F77      		andi r24,lo8(127)
 152 0088 8687      		std Z+14,r24
 153               	.LVL8:
 154 008a 00C0      		rjmp .L20
 155               	.LVL9:
 156               	.L15:
 157               	.LBE18:
 103:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb ****     {
 104:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb ****         // set response type for callback
 105:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb ****         setChunkResponse(thisChunk, response);
 158               		.loc 1 105 0
 159 008c 6871      		andi r22,lo8(24)
 160               	.LVL10:
 161 008e 5196      		adiw r26,17
 162 0090 8C91      		ld r24,X
 163 0092 5197      		sbiw r26,17
 164 0094 877E      		andi r24,lo8(-25)
 165 0096 682B      		or r22,r24
 166 0098 5196      		adiw r26,17
 167 009a 6C93      		st X,r22
 106:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb **** 	
 107:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb ****         // execute callback to clear memory and other user actions
 108:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb ****         (thisChunk->callback)();
 168               		.loc 1 108 0
 169 009c 1995      		eicall
 170               	.LVL11:
 171               	.L16:
 109:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb ****     }
 110:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb **** 
 111:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb ****     // we assume that the callback has freed memory
 112:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb ****     thisChunk = NULL;
 172               		.loc 1 112 0
 173 009e 1092 0000 		sts thisChunk,__zero_reg__
 174 00a2 1092 0000 		sts thisChunk+1,__zero_reg__
 113:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb ****     return 1;
 175               		.loc 1 113 0
 176 00a6 81E0      		ldi r24,lo8(1)
 177 00a8 0895      		ret
 178               	.LVL12:
 179               	.L19:
  78:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb ****         return 0;
 180               		.loc 1 78 0
 181 00aa 80E0      		ldi r24,0
 114:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb **** }
 182               		.loc 1 114 0
 183 00ac 0895      		ret
 184               	.LFE8:
 186               	.global	flushSendQueue
 188               	flushSendQueue:
 189               	.LFB9:
 115:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb **** 
 116:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb **** // flush a send queue (used when retries fails)
 117:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb **** void flushSendQueue(PRef p)
 118:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb **** {
 190               		.loc 1 118 0
 191               	.LVL13:
 192 00ae CF93      		push r28
 193               	.LCFI0:
 194               	/* prologue: function */
 195               	/* frame size = 0 */
 196               	/* stack size = 1 */
 197               	.L__stack_usage = 1
 198 00b0 C82F      		mov r28,r24
 119:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb ****     if(p < NUM_PORTS)
 199               		.loc 1 119 0
 200 00b2 8630      		cpi r24,lo8(6)
 201 00b4 00F4      		brsh .L21
 202               	.LVL14:
 203               	.L24:
 120:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb ****     {
 121:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb ****         // flush buffer (call all callbacks as if all messages failed)
 122:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb ****         while( removeFromSq(p, MSG_RESP_NOREPLY) );
 204               		.loc 1 122 0
 205 00b6 68E1      		ldi r22,lo8(24)
 206 00b8 8C2F      		mov r24,r28
 207 00ba 0E94 0000 		call removeFromSq
 208               	.LVL15:
 209 00be 8111      		cpse r24,__zero_reg__
 210 00c0 00C0      		rjmp .L24
 211               	.L21:
 212               	/* epilogue start */
 123:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb ****     }
 124:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb **** }
 213               		.loc 1 124 0
 214 00c2 CF91      		pop r28
 215               	.LVL16:
 216 00c4 0895      		ret
 217               	.LFE9:
 219               	.global	setupChunk
 221               	setupChunk:
 222               	.LFB10:
 125:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb **** ///////////////// END PROTECTED FUNCTIONS /////////////////
 126:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb **** 
 127:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb **** //////////////////// PUBLIC FUNCTIONS /////////////////////
 128:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb **** // correctly formats/prepares all components of the chunk for sending
 129:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb **** // inputs:  c - chunk to format
 130:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb **** //          port - port to send on (0-NUM_PORTS only)
 131:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb **** //          msg - data associated with the message
 132:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb **** //          length - length of the data portion only
 133:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb **** //          mh - handler for this message
 134:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb **** //          cb - callback on send failure
 135:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb **** // outputs: 1 - chunk correctly formatted
 136:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb **** //          0 - inputs contained error, format failed
 137:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb **** byte setupChunk(Chunk* c, PRef p, byte * msg, byte length, MsgHandler mh, GenericHandler cb)
 138:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb **** {
 223               		.loc 1 138 0
 224               	.LVL17:
 225 00c6 EF92      		push r14
 226               	.LCFI1:
 227 00c8 FF92      		push r15
 228               	.LCFI2:
 229 00ca 0F93      		push r16
 230               	.LCFI3:
 231 00cc 1F93      		push r17
 232               	.LCFI4:
 233 00ce CF93      		push r28
 234               	.LCFI5:
 235 00d0 DF93      		push r29
 236               	.LCFI6:
 237               	/* prologue: function */
 238               	/* frame size = 0 */
 239               	/* stack size = 6 */
 240               	.L__stack_usage = 6
 241 00d2 EC01      		movw r28,r24
 242 00d4 CA01      		movw r24,r20
 243               	.LVL18:
 139:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb ****     // invalid Chunk, invalid port, message too long, or no message
 140:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb ****     if( (c == NULL) || (p >= NUM_PORTS) || (length > DATA_SIZE) || (msg == NULL) )
 244               		.loc 1 140 0
 245 00d6 2097      		sbiw r28,0
 246 00d8 01F0      		breq .L31
 247               		.loc 1 140 0 is_stmt 0 discriminator 1
 248 00da 6630      		cpi r22,lo8(6)
 249 00dc 00F4      		brsh .L31
 250 00de 2231      		cpi r18,lo8(18)
 251 00e0 00F4      		brsh .L31
 252 00e2 0097      		sbiw r24,0
 253 00e4 01F0      		breq .L31
 141:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb ****     {
 142:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb ****         return 0;
 143:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb ****     }
 144:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb **** 
 145:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb ****     // set the flags
 146:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb ****     c->status = CHUNK_USED | CHUNK_FILLED | MSG_RESP_SENDING | port[p].pnum;
 254               		.loc 1 146 0 is_stmt 1
 255 00e6 38E5      		ldi r19,lo8(88)
 256 00e8 639F      		mul r22,r19
 257 00ea F001      		movw r30,r0
 258 00ec 1124      		clr __zero_reg__
 259 00ee E050      		subi r30,lo8(-(port))
 260 00f0 F040      		sbci r31,hi8(-(port))
 261 00f2 3081      		ld r19,Z
 262 00f4 3068      		ori r19,lo8(-128)
 263 00f6 398B      		std Y+17,r19
 147:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb ****     
 148:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb ****     // clear out next pointer
 149:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb ****     c->next = NULL;
 264               		.loc 1 149 0
 265 00f8 1A8A      		std Y+18,__zero_reg__
 266 00fa 1B8A      		std Y+19,__zero_reg__
 150:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb **** 
 151:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb ****     // set message handler
 152:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb ****     *((MsgHandler*)(c->handler)) = mh;
 267               		.loc 1 152 0
 268 00fc 0C8B      		std Y+20,r16
 269 00fe 1D8B      		std Y+21,r17
 153:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb **** 
 154:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb ****     // setup callback
 155:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb ****     c->callback = cb;
 270               		.loc 1 155 0
 271 0100 EE8A      		std Y+22,r14
 272 0102 FF8A      		std Y+23,r15
 156:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb **** 
 157:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb ****     // copy message
 158:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb ****     memcpy(c->data, msg, length);
 273               		.loc 1 158 0
 274 0104 022F      		mov r16,r18
 275               	.LVL19:
 276 0106 10E0      		ldi r17,0
 277 0108 422F      		mov r20,r18
 278               	.LVL20:
 279 010a 50E0      		ldi r21,0
 280 010c BC01      		movw r22,r24
 281               	.LVL21:
 282 010e CE01      		movw r24,r28
 283               	.LVL22:
 284 0110 0E94 0000 		call memcpy
 285               	.LVL23:
 159:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb ****     
 160:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb ****     // 'zero' out extra bytes (use ff's)
 161:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb ****     memset((c->data)+length, 0xFF, DATA_SIZE-length);
 286               		.loc 1 161 0
 287 0114 C00F      		add r28,r16
 288 0116 D11F      		adc r29,r17
 289               	.LVL24:
 290 0118 41E1      		ldi r20,lo8(17)
 291 011a 50E0      		ldi r21,0
 292 011c 401B      		sub r20,r16
 293 011e 510B      		sbc r21,r17
 294 0120 6FEF      		ldi r22,lo8(-1)
 295 0122 70E0      		ldi r23,0
 296 0124 CE01      		movw r24,r28
 297 0126 0E94 0000 		call memset
 298               	.LVL25:
 162:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb ****     
 163:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb ****     return 1;
 299               		.loc 1 163 0
 300 012a 81E0      		ldi r24,lo8(1)
 301 012c 00C0      		rjmp .L27
 302               	.LVL26:
 303               	.L31:
 142:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb ****         return 0;
 304               		.loc 1 142 0
 305 012e 80E0      		ldi r24,0
 306               	.LVL27:
 307               	.L27:
 308               	/* epilogue start */
 164:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb **** }
 309               		.loc 1 164 0
 310 0130 DF91      		pop r29
 311 0132 CF91      		pop r28
 312 0134 1F91      		pop r17
 313 0136 0F91      		pop r16
 314 0138 FF90      		pop r15
 315 013a EF90      		pop r14
 316               	.LVL28:
 317 013c 0895      		ret
 318               	.LFE10:
 320               	.global	queueChunk
 322               	queueChunk:
 323               	.LFB11:
 165:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb **** 
 166:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb **** // queues the chunk for sending
 167:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb **** // no guarantee chunk will be received - best-effort only
 168:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb **** // inputs:  c - correctly formatted chunk
 169:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb **** // outputs: 1 - chunk successfully queued
 170:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb **** //          0 - error, chunk was not queued
 171:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb **** byte queueChunk(Chunk* c)
 172:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb **** {
 324               		.loc 1 172 0
 325               	.LVL29:
 326               	/* prologue: function */
 327               	/* frame size = 0 */
 328               	/* stack size = 0 */
 329               	.L__stack_usage = 0
 173:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb ****     // null Chunk
 174:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb ****     if(c == NULL)
 330               		.loc 1 174 0
 331 013e 0097      		sbiw r24,0
 332 0140 01F0      		breq .L37
 175:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb ****     {
 176:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb ****         return 0;    
 177:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb ****     }
 178:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb ****     
 179:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb ****     byte p = faceNum(c);
 333               		.loc 1 179 0
 334 0142 DC01      		movw r26,r24
 335 0144 5196      		adiw r26,17
 336 0146 EC91      		ld r30,X
 337 0148 E770      		andi r30,lo8(7)
 338               	.LVL30:
 180:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb ****     
 181:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb ****     if(p < NUM_PORTS)
 339               		.loc 1 181 0
 340 014a E630      		cpi r30,lo8(6)
 341 014c 00F4      		brsh .L34
 342               	.LBB19:
 182:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb ****     {
 183:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb **** #ifdef DEBUG
 184:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb **** #if DEBUG == 5 // UP
 185:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb **** 
 186:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb **** #define DEBUGPORT 5
 187:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb **** #define DEBUGUART USARTD1
 188:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb **** 
 189:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb **** #elif DEBUG == 1 // NORTH
 190:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb **** 
 191:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb **** #define DEBUGPORT 1
 192:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb **** #define DEBUGUART USARTC1
 193:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb **** 
 194:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb **** #elif DEBUG == 4 //SOUTH
 195:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb **** 
 196:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb **** #define DEBUGPORT 4
 197:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb **** #define DEBUGUART USARTE0
 198:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb **** 
 199:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb **** #elif DEBUG == 2 //EAST
 200:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb **** 
 201:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb **** #define DEBUGPORT 2
 202:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb **** #define DEBUGUART USARTF0
 203:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb **** 
 204:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb **** #elif DEBUG == 3 //WEST
 205:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb **** 
 206:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb **** #define DEBUGPORT 3
 207:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb **** #define DEBUGUART USARTC0
 208:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb **** 
 209:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb **** #elif DEBUG == 0 //DOWN
 210:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb **** 
 211:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb **** #define DEBUGPORT 0
 212:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb **** #define DEBUGUART USARTD0
 213:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb **** 
 214:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb **** #endif
 215:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb **** #ifndef DEBUGPORT
 216:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb **** #error Invalid DEBUG option chosen - use a face enum.
 217:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb **** #endif
 218:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb **** 
 219:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb ****         if(p == DEBUGPORT)
 220:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb ****         {
 221:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb ****             freeChunk(c);
 222:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb ****             return 0;
 223:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb ****         }
 224:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb **** #endif    
 225:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb ****     
 226:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb ****         BB_LOCK(SQ_LOCK)
 343               		.loc 1 226 0
 344 014e 6FB7      		in r22,__SREG__
 345               	.LVL31:
 346               	.LBB20:
 347               	.LBB21:
  50:/usr/lib/gcc/avr/4.7.2/../../../avr/include/util/atomic.h ****     cli();
 348               		.loc 2 50 0
 349               	/* #APP */
 350               	 ;  50 "/usr/lib/gcc/avr/4.7.2/../../../avr/include/util/atomic.h" 1
 351 0150 F894      		cli
 352               	 ;  0 "" 2
 353               	.LVL32:
 354               	/* #NOAPP */
 355               	.LBE21:
 356               	.LBE20:
 227:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb **** 
 228:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb ****         // add to queue - queue empty
 229:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb ****         if( port[p].sq.head == NULL ) 
 357               		.loc 1 229 0
 358 0152 2E2F      		mov r18,r30
 359 0154 30E0      		ldi r19,0
 360 0156 B8E5      		ldi r27,lo8(88)
 361 0158 EB9F      		mul r30,r27
 362 015a F001      		movw r30,r0
 363 015c 1124      		clr __zero_reg__
 364               	.LVL33:
 365 015e E050      		subi r30,lo8(-(port))
 366 0160 F040      		sbci r31,hi8(-(port))
 367 0162 4785      		ldd r20,Z+15
 368 0164 5089      		ldd r21,Z+16
 369 0166 452B      		or r20,r21
 370 0168 01F4      		brne .L35
 230:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb ****         {
 231:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb ****             port[p].sq.head = c;
 371               		.loc 1 231 0
 372 016a 8787      		std Z+15,r24
 373 016c 908B      		std Z+16,r25
 374 016e 00C0      		rjmp .L36
 375               	.L35:
 232:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb ****         }
 233:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb ****         // queue has stuff
 234:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb ****         else 
 235:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb ****         {
 236:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb ****             port[p].sq.tail->next = c;
 376               		.loc 1 236 0
 377 0170 0188      		ldd __tmp_reg__,Z+17
 378 0172 F289      		ldd r31,Z+18
 379 0174 E02D      		mov r30,__tmp_reg__
 380 0176 828B      		std Z+18,r24
 381 0178 938B      		std Z+19,r25
 382               	.L36:
 237:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb ****         }
 238:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb ****         // add to tail and update flags
 239:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb ****         port[p].sq.tail   = c;
 383               		.loc 1 239 0
 384 017a 48E5      		ldi r20,lo8(88)
 385 017c 429F      		mul r20,r18
 386 017e F001      		movw r30,r0
 387 0180 439F      		mul r20,r19
 388 0182 F00D      		add r31,r0
 389 0184 1124      		clr __zero_reg__
 390 0186 E050      		subi r30,lo8(-(port))
 391 0188 F040      		sbci r31,hi8(-(port))
 392 018a 818B      		std Z+17,r24
 393 018c 928B      		std Z+18,r25
 240:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb ****         port[p].sq.flags |= CHUNK_READY;
 394               		.loc 1 240 0
 395 018e 8685      		ldd r24,Z+14
 396               	.LVL34:
 397 0190 8068      		ori r24,lo8(-128)
 398 0192 8687      		std Z+14,r24
 399               	.LVL35:
 400               	.LBB22:
 401               	.LBB23:
  70:/usr/lib/gcc/avr/4.7.2/../../../avr/include/util/atomic.h ****     SREG = *__s;
 402               		.loc 2 70 0
 403 0194 6FBF      		out __SREG__,r22
 404               		.loc 2 71 0
 405               	.LBE23:
 406               	.LBE22:
 407               	.LBE19:
 241:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb **** 
 242:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb ****         BB_UNLOCK(SQ_LOCK)
 243:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb **** 
 244:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb ****         return 1;
 408               		.loc 1 244 0
 409 0196 81E0      		ldi r24,lo8(1)
 410 0198 0895      		ret
 411               	.LVL36:
 412               	.L34:
 245:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb ****     }
 246:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb ****     else
 247:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb ****     {
 248:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb ****         freeChunk(c);
 413               		.loc 1 248 0
 414 019a 0E94 0000 		call freeChunk
 415               	.LVL37:
 416               	.L37:
 176:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb ****         return 0;    
 417               		.loc 1 176 0
 418 019e 80E0      		ldi r24,0
 249:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb ****         return 0;
 250:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb ****     }
 251:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb **** }
 419               		.loc 1 251 0
 420 01a0 0895      		ret
 421               	.LFE11:
 423               	.global	handleOneMessage
 425               	handleOneMessage:
 426               	.LFB12:
 252:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb **** 
 253:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb **** // call active message handler and send ack
 254:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb **** // returns: 1 - message processed
 255:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb **** //          0 - no new messages
 256:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb **** byte handleOneMessage()
 257:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb **** {
 427               		.loc 1 257 0
 428               	/* prologue: function */
 429               	/* frame size = 0 */
 430               	/* stack size = 0 */
 431               	.L__stack_usage = 0
 258:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb ****     // set the global chunk that needs to be processed by the handler
 259:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb ****     thisChunk = nextPacket();
 432               		.loc 1 259 0
 433 01a2 0E94 0000 		call nextPacket
 434               	.LVL38:
 435 01a6 8093 0000 		sts thisChunk,r24
 436 01aa 9093 0000 		sts thisChunk+1,r25
 260:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb **** 
 261:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb ****     // no packet, no action
 262:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb ****     if( thisChunk == NULL )
 437               		.loc 1 262 0
 438 01ae 0097      		sbiw r24,0
 439 01b0 01F0      		breq .L42
 263:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb ****     {
 264:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb ****         return 0;
 265:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb ****     }
 266:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb **** 
 267:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb ****     // call handler
 268:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb ****     if( *((MsgHandler*)thisChunk->handler) == RES_SYS_HANDLER ) 
 440               		.loc 1 268 0
 441 01b2 DC01      		movw r26,r24
 442 01b4 5496      		adiw r26,20
 443 01b6 ED91      		ld r30,X+
 444 01b8 FC91      		ld r31,X
 445 01ba 5597      		sbiw r26,20+1
 446 01bc 3097      		sbiw r30,0
 447 01be 01F4      		brne .L40
 269:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb ****     {
 270:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb **** 	    reservedSystemHandler();
 448               		.loc 1 270 0
 449 01c0 0E94 0000 		call reservedSystemHandler
 450               	.LVL39:
 451 01c4 00C0      		rjmp .L41
 452               	.L40:
 271:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb ****     }
 272:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb ****     else 
 273:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb ****     {
 274:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb **** 	    (*((MsgHandler*)(thisChunk->handler)))();
 453               		.loc 1 274 0
 454 01c6 1995      		eicall
 455               	.LVL40:
 456               	.L41:
 275:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb ****     }
 276:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb **** 
 277:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb ****     // set flag to send ACK
 278:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb ****     port[faceNum(thisChunk)].sq.flags |= setAck(thisChunk);
 457               		.loc 1 278 0
 458 01c8 8091 0000 		lds r24,thisChunk
 459 01cc 9091 0000 		lds r25,thisChunk+1
 460 01d0 FC01      		movw r30,r24
 461 01d2 2189      		ldd r18,Z+17
 462 01d4 E22F      		mov r30,r18
 463 01d6 E770      		andi r30,lo8(7)
 464 01d8 38E5      		ldi r19,lo8(88)
 465 01da E39F      		mul r30,r19
 466 01dc F001      		movw r30,r0
 467 01de 1124      		clr __zero_reg__
 468 01e0 E050      		subi r30,lo8(-(port))
 469 01e2 F040      		sbci r31,hi8(-(port))
 470 01e4 25FB      		bst r18,5
 471 01e6 4427      		clr r20
 472 01e8 40F9      		bld r20,0
 473 01ea 21E0      		ldi r18,lo8(1)
 474 01ec 30E0      		ldi r19,0
 475 01ee 00C0      		rjmp 2f
 476               		1:
 477 01f0 220F      		lsl r18
 478               		2:
 479 01f2 4A95      		dec r20
 480 01f4 02F4      		brpl 1b
 481 01f6 3685      		ldd r19,Z+14
 482 01f8 322B      		or r19,r18
 483 01fa 3687      		std Z+14,r19
 279:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb **** 
 280:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb ****     // free the rx chunk
 281:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb ****     freeChunk(thisChunk);
 484               		.loc 1 281 0
 485 01fc 0E94 0000 		call freeChunk
 486               	.LVL41:
 282:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb **** 
 283:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb ****     // reset the global chunk since memory is no longer valid
 284:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb ****     thisChunk = NULL;
 487               		.loc 1 284 0
 488 0200 1092 0000 		sts thisChunk,__zero_reg__
 489 0204 1092 0000 		sts thisChunk+1,__zero_reg__
 285:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb **** 
 286:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb ****     return 1;
 490               		.loc 1 286 0
 491 0208 81E0      		ldi r24,lo8(1)
 492 020a 0895      		ret
 493               	.L42:
 264:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb ****         return 0;
 494               		.loc 1 264 0
 495 020c 80E0      		ldi r24,0
 287:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb **** }
 496               		.loc 1 287 0
 497 020e 0895      		ret
 498               	.LFE12:
 500               	.global	initDataLink
 502               	initDataLink:
 503               	.LFB13:
 288:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb **** 
 289:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb **** // initialization
 290:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb **** void initDataLink()
 291:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb **** {
 504               		.loc 1 291 0
 505               	/* prologue: function */
 506               	/* frame size = 0 */
 507               	/* stack size = 0 */
 508               	.L__stack_usage = 0
 292:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb ****     initHWDataLink();
 509               		.loc 1 292 0
 510 0210 0E94 0000 		call initHWDataLink
 511               	.LVL42:
 293:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb **** 
 294:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb ****     globalRq.head  = NULL;
 512               		.loc 1 294 0
 513 0214 1092 0000 		sts globalRq,__zero_reg__
 514 0218 1092 0000 		sts globalRq+1,__zero_reg__
 295:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb ****     globalRq.tail  = NULL;
 515               		.loc 1 295 0
 516 021c 1092 0000 		sts globalRq+2,__zero_reg__
 517 0220 1092 0000 		sts globalRq+2+1,__zero_reg__
 296:/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/data_link.bb ****     globalRq.flags = 0;
 518               		.loc 1 296 0
 519 0224 1092 0000 		sts globalRq+4,__zero_reg__
 520 0228 0895      		ret
 521               	.LFE13:
 523               		.comm	thisChunk,2,1
 524               		.comm	globalRq,5,1
 649               	.Letext0:
 650               		.file 3 "/usr/lib/gcc/avr/4.7.2/../../../avr/include/stdint.h"
 651               		.file 4 "/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/defs.bbh"
 652               		.file 5 "/usr/lib/gcc/avr/4.7.2/include/stddef.h"
 653               		.file 6 "/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/circ_buffer.bbh"
 654               		.file 7 "/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/handler.bbh"
 655               		.file 8 "/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/memory.bbh"
 656               		.file 9 "/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/hardwaretime.bbh"
 657               		.file 10 "/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/queues.bbh"
 658               		.file 11 "/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/serial.bbh"
 659               		.file 12 "/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/ensemble.bbh"
 660               		.file 13 "/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/../hw-api/hwDataLink.
 661               		.file 14 "/home/dcampbel/Research/blinkyBocksHardware/build/src-bobby/system/boot.bbh"
 662               		.file 15 "/usr/lib/gcc/avr/4.7.2/../../../avr/include/string.h"
DEFINED SYMBOLS
                            *ABS*:0000000000000000 data_link.c
     /tmp/ccu7zVWI.s:2      *ABS*:000000000000003e __SP_H__
     /tmp/ccu7zVWI.s:3      *ABS*:000000000000003d __SP_L__
     /tmp/ccu7zVWI.s:4      *ABS*:000000000000003f __SREG__
     /tmp/ccu7zVWI.s:5      *ABS*:000000000000003b __RAMPZ__
     /tmp/ccu7zVWI.s:6      *ABS*:0000000000000034 __CCP__
     /tmp/ccu7zVWI.s:7      *ABS*:0000000000000000 __tmp_reg__
     /tmp/ccu7zVWI.s:8      *ABS*:0000000000000001 __zero_reg__
     /tmp/ccu7zVWI.s:13     .text:0000000000000000 defaultMsgHandler
     /tmp/ccu7zVWI.s:28     .text:0000000000000004 reservedSystemHandler
                            *COM*:0000000000000002 thisChunk
     /tmp/ccu7zVWI.s:63     .text:0000000000000026 removeFromSq
     /tmp/ccu7zVWI.s:188    .text:00000000000000ae flushSendQueue
     /tmp/ccu7zVWI.s:221    .text:00000000000000c6 setupChunk
     /tmp/ccu7zVWI.s:322    .text:000000000000013e queueChunk
     /tmp/ccu7zVWI.s:425    .text:00000000000001a2 handleOneMessage
     /tmp/ccu7zVWI.s:502    .text:0000000000000210 initDataLink
                            *COM*:0000000000000005 globalRq

UNDEFINED SYMBOLS
jumpToBootSection
handleNeighborMessage
port
memcpy
memset
freeChunk
nextPacket
initHWDataLink
__do_clear_bss
